Веб-приложения — это особенный вид сетевых сервисов, доступных для атак хакера, т.к. эти сервисы при разработке по умолчанию неуязвимы, в отличие от некоторых коробочных решений, которые после развертывания сразу обладают рядом проблем безопасности, которые нужно превентивно устранить.

Аутентификация — это процесс проверки подлинности идентификационных данных пользователя, таких, как логин и пароль, чтобы убедиться, что он является тем, за кого себя выдает; по сути, процесс проверки личности конкретного пользователя или клиента для последующего доступа к ресурсу.

Авторизация — это процесс проверки прав пользователя на выполнение определенных действий или доступ к определенным ресурсам системы. Пользователь может быть аутентифицирован, но не авторизован на выполнение определенной операции, если у него нет необходимых прав.

Идентификация — это процесс определения личности пользователя на основе предоставленных им идентификационных данных, таких как имя, адрес электронной почты или номер телефона. Идентификация часто используется вместе с аутентификацией для подтверждения подлинности пользователя.

Атака грубой силы — это метод криптоанализа, при котором злоумышленник пытается взломать пароль или зашифрованные данные путем перебора возможных комбинаций до тех пор, пока не будет найдено правильное сочетание. Атака грубой силы может быть эффективной, если пароль короткий или используется слабый алгоритм шифрования, однако, при достаточной длине и сложности пароля, такая атака может занять слишком много времени или быть совсем неэффективной.

Инъекция команд ОС (также известная как shell инъекция) — уязвимость веб-приложений, которая позволяет злоумышленнику выполнять произвольные команды операционной системы (ОС) на сервере, на котором запущено приложение, и, как правило, дает возможность полностью скомпрометировать приложение и все его данные.

Очень часто злоумышленник может использовать уязвимость внедрения команд ОС для компрометации других частей инфраструктуры, используя доверительные отношения для перенаправления атаки на другие системы в организации.

Контроль доступа — это процесс управления доступом пользователей к ресурсам системы, включая определение прав доступа и ограничений на использование ресурсов. Контроль доступа обеспечивает безопасность системы, ограничивая доступ пользователей только к необходимым ресурсам и операциям.

Язык структурированных запросов (SQL) – это язык программирования для хранения и обработки информации в реляционной базе данных. Реляционная база данных хранит информацию в табличной форме со строками и столбцами, представляющими различные атрибуты данных и различные связи между значениями данных. Инструкции SQL можно использовать для хранения, обновления, удаления, поиска и извлечения информации из базы данных. Можно также использовать SQL для поддержания и оптимизации производительности базы данных.

SQL-инъекция — это уязвимость веб-приложений, позволяющая злоумышленнику вмешиваться в запросы, которые приложение делает к своей базе данных. Она позволяет злоумышленнику просматривать данные, которые он, как правило, не может получить.

Обратный путь в каталогах (также известный как обход файловых путей) — это уязвимость веб-безопасности, позволяющая злоумышленнику читать произвольные файлы на сервере, на котором запущено приложение. Сюда могут входить код приложения и данные, учетные данные для внутренних систем и конфиденциальные файлы операционной системы.

Расширяемый язык разметки (XML) позволяет определять и хранить данные совместно используемым способом. XML поддерживает обмен информацией между компьютерными системами, такими, как веб-сайты, базы данных и сторонние приложения. Предопределенные правила упрощают передачу данных в виде XML-файлов по любой сети, поскольку получатель может использовать эти правила для точного и эффективного чтения данных.

Инъекция внешних сущностей XML (также известная как XXE) — это уязвимость веб-безопасности, позволяющая злоумышленнику вмешиваться в обработку XML-данных приложения. Часто она позволяет злоумышленнику просматривать файлы на файловой системе сервера приложений, а также взаимодействовать с любыми внутренними или внешними системами, к которым имеет доступ само приложение.

В большом числе случаев злоумышленник может усилить атаку XXE для компрометации основного сервера или другой внутренней инфраструктуры, используя уязвимость XXE для выполнения атак на подделку запроса на стороне сервера (SSRF).

Межсайтовый скриптинг (также известный как XSS) — это уязвимость веб-безопасности, позволяющая злоумышленнику компрометировать взаимодействие пользователей с уязвимым приложением. Она позволяет злоумышленнику обходить политику одного источника (Same Origin Policy (SOP)), которая предназначена для разделения различных веб сайтов друг от друга.

# 5

​​Существуют такие механизмы управления и защиты информации, как идентификация, авторизация и аутентификация.

Идентификация — процедура, в результате выполнения которой для субъекта идентификации присваивается его идентификатор, однозначно определяющий этого субъекта в информационной системе.
Аутентификация — процедура проверки подлинности, например проверка подлинности пользователя путем сравнения введенного им пароля с паролем, сохраненным в базе данных. Подтверждает, что он является тем, за кого себя выдает.
Авторизация — предоставление определенному лицу или группе лиц прав на выполнение определенных действий. Эта процедура проверяет есть ли права у пользователя на исполнение запрашиваемых им операций.

Уязвимости в механизмах аутентификации
Система аутентификации веб-сайта, как правило, состоит из нескольких различных механизмов, в которых могут возникать уязвимости. Некоторые уязвимости широко применимы во всех этих контекстах, в то время как другие более специфичны с точки зрения предоставляемой функциональности.

Рассмотрим более подробно некоторые из наиболее распространенных уязвимостей в следующих областях:

Уязвимости при входе на основе пароля
Уязвимости при многофакторной аутентификации
Уязвимости в других механизмах аутентификации
Уязвимости в Password-based аутентификации
Для веб-сайтов, использующих процесс входа на основе пароля, пользователи либо сами регистрируются для получения учетной записи, либо администратор присваивает им учетную запись. Эта учетная запись связана с уникальным именем пользователя и секретным паролем, который пользователь вводит в форме входа для аутентификации.

В этом сценарии сам факт знания секретного пароля воспринимается как достаточное доказательство личности пользователя. Следовательно, безопасность сайта будет скомпрометирована, если злоумышленник сможет либо получить, либо угадать учетные данные другого пользователя.

Уязвимости в этом механизме возникают по различным причинам, одни из них:

Возможные brute-force атаки
Уязвимая защита от brute-force атак
HTTP-basic аутентификация

Brute-force атаки
Brute-forcing пользовательских имен
Имена пользователей особенно легко угадать, если они соответствуют узнаваемому шаблону, например, адресу электронной почты. Очень часто можно увидеть логины в формате:

firstname.lastname@somecompany.com

Однако, даже если нет очевидного шаблона, иногда даже высокопривилегированные учетные записи создаются с использованием предсказуемых имен пользователей, таких как admin или administrator.

## Brute-forcing паролей

Пароли могут быть перебраны аналогичным образом в зависимости от сложности пароля. Многие сайты принимают ту или иную форму политики паролей, которая заставляет пользователей создавать пароли с высокой энтропией, которые, по крайней мере, теоретически сложнее взломать одним перебором. Обычно это включает в себя принудительное использование в паролях:

Минимального количества символов
Смеси строчных и заглавных букв
Как минимум одного специального символа
Однако, несмотря на то, что высокоэнтропийные пароли сложно взломать компьютеру, мы можем использовать базовые знания о человеческом поведении для эксплуатации уязвимостей, которые пользователи невольно привносят в эту систему.

Вместо того, чтобы создавать надежный пароль со случайной комбинацией символов, пользователи часто берут пароль, который они могут запомнить, и пытаются использовать его в соответствие с политикой паролей. Например, если не разрешено использование password, пользователи могут попробовать что-нибудь вроде P@ssw0rd или P4$$w0rd!.

Такое знание предсказуемых закономерностей означает, что атаки с применением грубой силы часто могут быть гораздо более изощренными и, следовательно, более эффективными, чем простые итерации через всевозможные комбинации символов.

Уязвимая защита от brute-force атак
Высока вероятность того, что атака с применением грубой силы будет включать в себя множество неудачных попыток, прежде чем атакующий успешно скомпрометирует учетную запись. По логике вещей, защита полным перебором заключается в попытке замедлить скорость автоматизации ввода пароля, с которой злоумышленник может попытаться войти в систему.

Двумя наиболее распространенными способами предотвращения атак полным перебором являются следующие:

Блокировка учетной записи, к которой удаленный пользователь пытается получить доступ, если он совершает слишком много неудачных попыток входа.
Блокировка IP-адреса удаленного пользователя, если он делает слишком много попыток входа в систему.
Оба подхода предлагают разную степень защиты, но ни один из них не является неуязвимым, особенно если он реализуется с использованием ошибочной логики.

Иногда вы можете обнаружить, что ваш IP заблокирован, если вы не можете войти слишком много раз. В некоторых реализациях счетчик количества неудачных попыток сбрасывается при успешном входе владельца IP-адреса. Это означает, что злоумышленнику просто придется входить в систему под своей учетной записью каждые несколько попыток, чтобы этот лимит никогда не был достигнут.

В этом случае достаточно просто включать свои собственные учетные данные для входа в систему через регулярные интервалы времени в течение перебора всего словаря, чтобы сделать эту защиту практически бесполезной.

Basic-аутентификация HTTP
Несмотря на то, что эта аутентификация достаточно старая, ее относительная простота и легкость реализации ведет к тому, что можно достаточно часто видеть использование базовой аутентификации по HTTP.

При базовой HTTP-аутентификации клиент получает от сервера маркер аутентификации, который строится путем сцепления имени пользователя и пароля, а также их кодировки в Base64. Этот токен хранится и управляется браузером, который автоматически добавляет его в заголовок авторизации каждого последующего запроса следующим образом:

Authorization: Basic base64(username:password)
По ряду причин это, как правило, не считается безопасным методом аутентификации.

Во-первых, он включает в себя многократную отправку учетных данных пользователя при каждом запросе. Если на веб-сайте также не реализована HSTS, учетные данные пользователя могут быть перехвачены в ходе атаки типа Man-in-the-Middle (человек посередине).

Кроме того, реализация базовой аутентификации HTTP часто не поддерживает защиту от переборов грубой силы. Поскольку токен состоит исключительно из статических значений, это может сделать его уязвимым для перебора.

Базовая аутентификация HTTP также особенно уязвима к атакам, связанным с сеансом, в частности к CSRF, от которых она сама по себе не обеспечивает никакой защиты.

В некоторых случаях использование уязвимой базовой HTTP-аутентификации может дать злоумышленнику доступ только к, казалось бы, неинтересной странице. Однако, в дополнение к обеспечению дополнительной поверхности атаки, учетные данные, раскрытые таким образом, могут быть повторно использованы в других, более конфиденциальных контекстах.

## Уязвимости мультифакторной аутентификации

Многие веб-сайты полагаются исключительно на однофакторную аутентификацию с использованием пароля для аутентификации пользователей. Однако некоторые требуют от пользователей подтверждения их личности с помощью нескольких факторов аутентификации.

Проверка биометрических факторов является непрактичной для большинства веб сайтов. Однако все чаще встречается обязательная и необязательная двухфакторная аутентификация (2FA), основанная на том, что вы знаете и что у вас есть. Это
обычно требует от пользователей ввода как традиционного пароля, так и временного верификационного кода со стороннего физического устройства, находящегося у них в распоряжении.

Хотя иногда злоумышленник может получить один фактор, основанный на знаниях, например, пароль, вероятность одновременного получения другого фактора из стороннего источника значительно ниже. По этой причине двухфакторная аутентификация явно более безопасна, чем однофакторная. Однако, как и любая другая мера безопасности, она безопасна настолько, насколько и ее реализация. Плохо реализованную двухфакторную аутентификацию можно обойти частично или даже полностью, точно так же, как и однофакторную аутентификацию.

Следует также отметить, что все преимущества многофакторной аутентификации достигаются только путем проверки множества различных факторов. Проверка одного и того же фактора двумя разными способами не является истинной двухфакторной аутентификацией.

Одним из таких примеров является 2FA через электронную почту. Хотя пользователь должен предоставить пароль и проверочный код, доступ к коду предполагается на основе того, что пользователь знает учетные данные для входа в свою учетную запись электронной почты. Поэтому фактор проверки подлинности знания просто проверяется дважды.

Обход двухфакторной аутентификации возможен по разным причинам:

Иногда реализация двухфакторной аутентификации бывает настолько несовершенной, что ее можно обойти полностью.
Иногда ошибочная логика двухфакторной аутентификации означает, что после того, как пользователь выполнил начальный шаг входа в систему, веб-сайт не может адекватно проверить, что этот же пользователь выполняет второй шаг.
А также, как и в случае с паролями, веб-сайты должны принимать меры по предотвращению перебора проверочного кода 2FA. Это особенно важно, потому что код часто представляет собой простое 4-х или 6-значное число. Без адекватной защиты взлом такого кода тривиален.
Уязвимости механизмов смены пароля, восстановления пароля, поддержания сессии
В дополнение к базовой функциональности входа в систему, большинство сайтов предоставляют дополнительные функциональные возможности, позволяющие пользователям управлять своей учетной записью. Например, пользователи обычно могут изменить свой пароль или сбросить его, когда они его забудут. Эти механизмы также могут добавлять уязвимости, которые могут быть использованы злоумышленником.

Веб-сайты, как правило, стараются избежать известных уязвимостей на своих страницах входа. Однако легко упустить из виду тот факт, что необходимо предпринять аналогичные шаги, чтобы убедиться в том, что связанная с ними функциональность не менее надежна. Это особенно важно в тех случаях, когда злоумышленник может создать свою учетную запись и, следовательно, имеет легкий доступ к изучению этих дополнительных страниц.

Сторонние механизмы аутентификации, которые также могут быть уязвимы:

Механизм поддержания сессии «запомнить меня»
Механизм сброса пароля через E-mail
Механизм сброса пароля с использованием URL и одноразового токена
Механизм смены пароля
