# Восстановление паролей из хешей

<!-- Для восстановления паролей из хешированных значений пригодятся такие инструменты, как JohnTheRipper.

John the Ripper — это инструмент для восстановления паролей, который может использоваться для анализа файлов паролей и
попытки восстановления паролей. Для использования John the Ripper для анализа файлов паролей вам нужно выполнить
следующие команды: -->

sudo cp /etc/shadow /tmp/shadow
sudo unshadow /etc/passwd /tmp/shadow > /tmp/unshadowed
john /tmp/unshadowed

<!-- В случае, если вы обнаружили прочие хеши паролей от других сервисов в ОС, можно воспользоваться более универсальной
утилитой Hashcat.

Hashcat — это инструмент для взлома паролей, который может использоваться для анализа хешей паролей и попыток их взлома.

Hashcat поддерживает множество различных алгоритмов хеширования, таких как MD5, SHA1, SHA256, bcrypt и многие другие.
Вот пример команды для запуска hashcat для взлома хешей MD5: -->

hashcat -m 0 -a 0 hash.txt /usr/share/wordlists/rockyou.txt

где

<!-- % -m 0 означает, что мы используем алгоритм хеширования MD5
% -a 0 означает, что мы используем атаку перебора
% hash.txt — это файл с хешами паролей, которые мы пытаемся взломать
% /usr/share/wordlists/rockyou.txt — это словарь, который мы используем для перебора паролей.
% Это только один пример использования hashcat. Для каждого алгоритма хеширования и типа атаки существуют различные
% параметры и настройки, которые могут быть использованы в hashcat.
https://spy-soft.net/kak-rasshifrovat-xesh-bez-dolgix-vychislenij/ -->

# Подбор паролей методом перебора

<!-- На этом этапе могут быть использованы уже известные нам утилиты для атак методом перебора.

Минус такого подхода в качестве инструмента для закрепления доступа в том, что мы должны предустановить инструмент на машину для обеспечения большей скорости обращений, что с высокой долей вероятности будет заметно командой реагирования и отразится в журналах аудита.

Тем не менее такими инструментами могут послужить nmap, patator или hydra, а также прочие менее известные скрипты для атак методом перебора. Использовать такие инструменты лучше в виде портативных файлов для вашей версии ОС, чтобы не устанавливать их через стандартные механизмы ОС.

Пример команды для запуска атаки методом перебора на SSH сервис утилиты patator: -->

patator ssh*login host=192.168.0.1 user=admin password=FILE0 0=/путь/к/файлу*с_паролями.txt -x ignore:fgrep='Permission denied'

<!-- Пример команды для запуска атаки методом перебора на SSH-сервис утилиты nmap: -->

nmap --script ssh-brute --script-args userdb=usernames.txt,passdb=passwords.txt <target>, где

<!-- --script ssh-brute – указывает использование скрипта для перебора паролей ssh.
--script-args userdb=usernames.txt,passdb=passwords.txt – указывает на файлы, содержащие список пользователей и паролей соответственно.
<target> – целевой IP-адрес или диапазон адресов.
Скачать прекомпилированный бинарный файл nmap можно тут. -->

https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/nmap

# Восстановление паролей и ключей из памяти процессов

Восстановление паролей и ключей из памяти процессов в Linux реализовано не так разнообразно как в Windows, но тоже остается возможным. Для этого используются специальные инструменты и подходы.

Пример:
Mimipenguin — это инструмент для перехвата паролей из памяти процессов, работающих на Linux-системе. Обычно он
используется для получения паролей, введенных пользователем в терминал, например, паролей от системы или приложений.
После запуска Mimipenguin начнет мониторить процессы в системе и попытается извлечь пароли из памяти процессов. Если он найдет пароли — он отобразит их в терминале.

Другой пример:
truffleproc — это инструмент для перехвата паролей из памяти любых процессов работающих в системе Linux, который ищет
пароли и ключи API в процессах по регулярным выражениям выполняя выгрузку памяти процесса и анализируя ее.

Ссылка на инструмент: https://github.com/controlplaneio/truffleproc

Вы можете сделать то же самое вручную, выбрав нужный процесс.

Если вы обнаружите, что процесс аутентификации запущен:

# ps -ef | grep "authenticator"

> root 2027 2025 0 11:46 ? 00:00:00 authenticator

Вы можете сделать дамп процесса (например, инструментом memory-dump) и поискать учетные данные в памяти:

# ./dump-memory.sh 2027

# strings \*.dump | grep -i

Прочие подобные утилиты:

3snake – перехват паролей ssh, sudo и su (experimental)
SSHPry2.0 – перехват данных в терминале
Gimmecredz – дамп паролей в памяти (на основе bash)
